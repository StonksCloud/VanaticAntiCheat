package net.vounty.vanatic.detection.detections.exploit;

import io.github.retrooper.packetevents.packetwrappers.NMSPacket;
import io.github.retrooper.packetevents.packetwrappers.WrappedPacket;
import io.github.retrooper.packetevents.packetwrappers.play.in.setcreativeslot.WrappedPacketInSetCreativeSlot;
import net.vounty.vanatic.detection.VanaticDetection;
import net.vounty.vanatic.user.User;
import net.vounty.vanatic.utils.annotations.DetectionInformation;
import net.vounty.vanatic.utils.enums.*;
import org.bukkit.GameMode;
import org.bukkit.entity.Player;

@DetectionInformation(
        name = "Exploit",
        type = DetectionType.B,
        category = DetectionCategory.EXPLOIT,
        status = DetectionStatus.GLOBAL,
        banAmount = 3,
        kickAmount = 1
)
public class ExploitB extends VanaticDetection {

    @Override
    public Boolean onPacket(User user, NMSPacket nmsPacket, WrappedPacket wrappedPacket, ProtocolMode mode, ProtocolType type) {

        if (user == null)
            return false;

        final Player player = user.getPlayer();

        if (wrappedPacket instanceof WrappedPacketInSetCreativeSlot) {

            if (!player.getGameMode().equals(GameMode.CREATIVE)) {
                this.flagPlayer(player);
                return true;
            }

        }
        return false;
    }

}
